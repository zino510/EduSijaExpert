<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EduSijaExpert - Interactive Quiz</title>
  <meta name="description" content="Test your knowledge with EduSijaExpert - An interactive quiz platform" />
  <link rel="icon" href="favicon.png" />

  <!-- Fonts & styles -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">

  <style>
    :root{
      --primary: #4f46e5; /* indigo-600 */
      --accent: #8b5cf6;  /* purple-500 */
    }
    body{font-family:'Poppins',sans-serif; background:linear-gradient(135deg,#f0f7ff,#f9f5ff); margin:0; color:#0f172a;}
    .loading-screen{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#667eea,#764ba2);z-index:60}
    .loading-screen.hidden{opacity:0;pointer-events:none;transition:opacity .4s}
    .card{background:rgba(255,255,255,0.9);backdrop-filter: blur(6px);border-radius:18px;box-shadow:0 8px 30px rgba(2,6,23,.08)}
    .option-btn{border:1.5px solid #e6e9ef;padding:12px;border-radius:10px;cursor:pointer;transition:all .18s;user-select:none}
    .option-btn:hover{transform:translateY(-3px);box-shadow:0 6px 18px rgba(15,23,42,.06)}
    .option-btn.selected{background:linear-gradient(90deg,var(--primary),var(--accent));color:white;border-color:transparent}
    .btn {display:inline-flex;align-items:center;gap:.6rem;padding:.6rem .95rem;border-radius:10px;font-weight:600;cursor:pointer}
    .btn-primary{background:linear-gradient(90deg,var(--primary),var(--accent));color:white;border:none}
    .btn-ghost{background:transparent;border:1px solid #e6e9ef}
    .progress-track{height:10px;background:#eef2ff;border-radius:999px;overflow:hidden}
    .progress-fill{height:100%;background:linear-gradient(90deg,var(--primary),var(--accent));width:0;transition:width .45s ease}
    .timer-bar{height:6px;background:#fde68a;border-radius:999px;transition:width .2s linear}
    /* transitions between cards */
    .fade-enter{opacity:0;transform:translateY(8px)}
    .fade-enter.fade-enter-active{opacity:1;transform:none;transition:all .32s ease-out}
    .fade-exit{opacity:1}
    .fade-exit.fade-exit-active{opacity:0;transform:translateY(-6px);transition:all .28s ease-in}
    /* responsive */
    @media (max-width:640px){ .container{padding:1rem;} .card{border-radius:14px} }
  </style>
</head>
<body>
  <!-- Loading -->
  <div class="loading-screen" id="loadingScreen" aria-hidden="true">
    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="1.6">
      <path d="M12 2v4M20.485 3.515l-2.828 2.828M22 12h-4M20.485 20.485l-2.828-2.828M12 22v-4M3.515 20.485l2.828-2.828M2 12h4M3.515 3.515l2.828 2.828"/>
    </svg>
  </div>

  <main class="container mx-auto px-6 py-10 max-w-3xl">
    <!-- theme toggle -->
    <div class="flex justify-end mb-4">
      <button id="themeToggle" class="btn btn-ghost" aria-pressed="false" title="Toggle theme">üåô Theme</button>
    </div>

    <!-- Header -->
    <header class="text-center mb-8" data-aos="fade-down">
      <h1 class="text-3xl sm:text-5xl font-extrabold bg-clip-text text-transparent" style="background-image:linear-gradient(90deg,var(--primary),var(--accent))">
        EduSijaExpert
      </h1>
      <p class="mt-2 text-gray-600">Challenge yourself ‚Äî instant result, review answers, and share!</p>
    </header>

    <!-- Welcome card -->
    <section id="welcomeCard" class="card p-6 mb-6" data-aos="zoom-in">
      <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
        <div>
          <h2 class="text-xl font-semibold">Welcome to EduSijaExpert Quiz</h2>
          <p class="text-sm text-gray-600 mt-1">8 questions ‚Äî timer per question, and share your score.</p>
        </div>
        <div class="mt-3 sm:mt-0">
          <button id="startBtn" class="btn btn-primary">Start Quiz ‚ñ∂</button>
        </div>
      </div>
    </section>

    <!-- Quiz container -->
    <section id="quizArea" class="hidden">
      <!-- progress -->
      <div class="mb-4">
        <div class="flex items-center justify-between text-sm mb-2">
          <div>Question <span id="qIndex">1</span>/<span id="qTotal">8</span></div>
          <div id="timerLabel" class="text-sm text-gray-600">‚è± 00:30</div>
        </div>
        <div class="progress-track mb-2" aria-hidden="true"><div id="progFill" class="progress-fill"></div></div>
        <div class="progress-track" style="height:6px;background:#f3f4f6;">
          <div id="timerFill" class="timer-bar" style="width:100%"></div>
        </div>
      </div>

      <!-- question card -->
      <article id="questionCard" class="card p-6 mb-4 fade-enter-active" aria-live="polite" aria-atomic="true">
        <h3 id="questionText" class="text-lg font-semibold mb-4">Question text</h3>
        <div id="optionsList" class="grid gap-3"></div>
      </article>

      <!-- nav -->
      <div class="flex items-center justify-between gap-4">
        <button id="prevBtn" class="btn btn-ghost" aria-hidden="true">‚óÄ Previous</button>
        <div class="flex gap-3 ml-auto">
          <button id="skipBtn" class="btn btn-ghost">Skip</button>
          <button id="nextBtn" class="btn btn-primary" disabled>Next ‚ñ∂</button>
        </div>
      </div>
    </section>

    <!-- results -->
    <section id="resultsArea" class="hidden card p-6 mt-6" data-aos="zoom-in-up">
      <div class="text-center">
        <h2 class="text-2xl font-bold mb-2">Quiz Completed üéâ</h2>
        <div id="scoreLarge" class="text-4xl font-extrabold text-indigo-600 mb-1">0 / 8</div>
        <div class="flex justify-center gap-6 mb-4">
          <div><div id="correctCount" class="text-2xl font-semibold text-green-600">0</div><div class="text-xs text-gray-600">Correct</div></div>
          <div><div id="wrongCount" class="text-2xl font-semibold text-red-600">0</div><div class="text-xs text-gray-600">Wrong</div></div>
        </div>

        <div class="flex flex-wrap justify-center gap-3 mb-3">
          <button id="reviewBtn" class="btn btn-ghost">Review Answers</button>
          <button id="retryBtn" class="btn btn-primary">Try Again</button>
        </div>

        <div class="mt-3 text-sm text-gray-700">
          <span>Share your result:</span>
          <div class="inline-flex items-center gap-2 ml-2">
            <button id="shareWA" class="btn btn-ghost" title="Share to WhatsApp">WhatsApp</button>
            <button id="shareTW" class="btn btn-ghost" title="Share to Twitter">Twitter</button>
            <button id="shareFB" class="btn btn-ghost" title="Share to Facebook">Facebook</button>
            <button id="copyLink" class="btn btn-ghost" title="Copy share text">Copy</button>
          </div>
        </div>
      </div>
    </section>

    <!-- review modal (simple) -->
    <div id="reviewModal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4">
      <div class="card max-w-2xl w-full p-4">
        <div class="flex justify-between items-center mb-3">
          <h3 class="font-semibold">Review Answers</h3>
          <button id="closeReview" class="btn btn-ghost">Close</button>
        </div>
        <div id="reviewList" style="max-height:60vh;overflow:auto"></div>
      </div>
    </div>
  </main>

  <!-- scripts -->
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script>
    AOS.init({ duration:700, once:true });

    // --------- Data & state ----------
    const QUESTIONS = [
      { q: "What is 2 + 2?", opts: ["3","4","5","6"], a: 1 },
      { q: "Capital city of France?", opts: ["Berlin","Madrid","Paris","Rome"], a: 2 },
      { q: "HTML stands for?", opts: ["Hyper Text Markup Language","High Transfer Markup Line","Hyperlinks Text Meta Language","None"], a: 0 },
      { q: "CSS is primarily for?", opts: ["Styling web pages","Backend logic","Database","Networking"], a: 0 },
      { q: "Which language is client-side?", opts: ["PHP","Python","JavaScript","SQL"], a: 2 },
      { q: "5 x 5 = ?", opts: ["10","20","25","30"], a: 2 },
      { q: "Fastest land animal?", opts: ["Lion","Cheetah","Gazelle","Horse"], a: 1 },
      { q: "Formula of water?", opts: ["CO2","H2O","O2","H2"], a: 1 }
    ];
    const PER_QUESTION_SECONDS = 30; // seconds per question

    let idx = 0;
    let selected = Array(QUESTIONS.length).fill(null);
    let score = 0;
    let timer = null;
    let timeLeft = PER_QUESTION_SECONDS;

    // --------- Elements ----------
    const loadingScreen = document.getElementById('loadingScreen');
    const welcomeCard = document.getElementById('welcomeCard');
    const startBtn = document.getElementById('startBtn');
    const quizArea = document.getElementById('quizArea');
    const qIndexEl = document.getElementById('qIndex');
    const qTotalEl = document.getElementById('qTotal');
    const questionText = document.getElementById('questionText');
    const optionsList = document.getElementById('optionsList');
    const nextBtn = document.getElementById('nextBtn');
    const prevBtn = document.getElementById('prevBtn');
    const skipBtn = document.getElementById('skipBtn');
    const progFill = document.getElementById('progFill');
    const timerFill = document.getElementById('timerFill');
    const timerLabel = document.getElementById('timerLabel');
    const resultsArea = document.getElementById('resultsArea');
    const scoreLarge = document.getElementById('scoreLarge');
    const correctCount = document.getElementById('correctCount');
    const wrongCount = document.getElementById('wrongCount');
    const reviewBtn = document.getElementById('reviewBtn');
    const retryBtn = document.getElementById('retryBtn');
    const reviewModal = document.getElementById('reviewModal');
    const reviewList = document.getElementById('reviewList');
    const closeReview = document.getElementById('closeReview');
    const shareWA = document.getElementById('shareWA');
    const shareTW = document.getElementById('shareTW');
    const shareFB = document.getElementById('shareFB');
    const copyLink = document.getElementById('copyLink');
    const startTimeout = 700; // small delay to hide loading

    // theme toggle
    const themeToggle = document.getElementById('themeToggle');
    const body = document.body;
    themeToggle.addEventListener('click', () => {
      body.classList.toggle('dark');
      const pressed = body.classList.contains('dark');
      themeToggle.setAttribute('aria-pressed', pressed);
      themeToggle.textContent = pressed ? '‚òÄÔ∏è Light' : 'üåô Theme';
    });

    // hide loading after DOM ready
    window.addEventListener('load', () => {
      setTimeout(()=> loadingScreen.classList.add('hidden'), startTimeout);
    });

    // ---------- helpers ----------
    function msToTime(s){
      const m = Math.floor(s/60); const sec = s%60;
      return (m>0?String(m).padStart(2,'0')+':':'') + String(sec).padStart(2,'0');
    }

    function resetTimer(){
      clearInterval(timer);
      timeLeft = PER_QUESTION_SECONDS;
      timerFill.style.width = '100%';
      timerLabel.textContent = `‚è± ${msToTime(timeLeft)}`;
    }

    function startTimer(){
      resetTimer();
      timer = setInterval(()=> {
        timeLeft--;
        const percent = Math.max(0, (timeLeft/PER_QUESTION_SECONDS)*100);
        timerFill.style.width = percent + '%';
        timerLabel.textContent = `‚è± ${msToTime(timeLeft)}`;
        if(timeLeft <= 0){
          clearInterval(timer);
          // auto move forward and mark as null (treated as wrong)
          handleNext(true);
        }
      }, 1000);
    }

    // Render question & options (safe, no duplicate listeners)
    function renderQuestion(){
      const Q = QUESTIONS[idx];
      qIndexEl.textContent = idx+1;
      qTotalEl.textContent = QUESTIONS.length;
      questionText.textContent = Q.q;

      // animate fade: quick class swap
      questionText.parentElement.classList.add('fade-enter');
      requestAnimationFrame(()=> {
        questionText.parentElement.classList.add('fade-enter-active');
        setTimeout(()=> {
          questionText.parentElement.classList.remove('fade-enter','fade-enter-active');
        }, 350);
      });

      // build options
      optionsList.innerHTML = '';
      Q.opts.forEach((opt, i) => {
        const btn = document.createElement('button');
        btn.className = 'option-btn';
        btn.type = 'button';
        btn.setAttribute('aria-pressed', selected[idx] === i ? 'true' : 'false');
        btn.setAttribute('data-index', i);
        btn.textContent = opt;
        // if already selected, show selected
        if(selected[idx] === i) btn.classList.add('selected');
        // single listener per created element
        btn.addEventListener('click', () => {
          // deselect siblings
          Array.from(optionsList.children).forEach(c => {
            c.classList.remove('selected');
            c.setAttribute('aria-pressed','false');
          });
          btn.classList.add('selected');
          btn.setAttribute('aria-pressed','true');
          selected[idx] = i;
          nextBtn.disabled = false;
        });
        optionsList.appendChild(btn);
      });

      // UI adjustments
      prevBtn.style.visibility = idx === 0 ? 'hidden' : 'visible';
      nextBtn.textContent = (idx === QUESTIONS.length-1) ? 'Finish' : 'Next';
      nextBtn.disabled = selected[idx] === null;
      // progress
      const prog = ((idx)/QUESTIONS.length)*100;
      progFill.style.width = prog + '%';
      // start timer for this question
      startTimer();
    }

    // handle next (auto param when timed out)
    function handleNext(auto=false){
      clearInterval(timer);
      // If timed out and no selection, leave selected[idx] as null (counts wrong)
      // If user pressed Next but no selection -> should be prevented by disabled button
      if(!auto && selected[idx] === null) return; // safety
      // If last question -> finish
      if(idx === QUESTIONS.length-1){
        // compute score
        computeResults();
        return;
      }
      // move to next
      idx++;
      renderQuestion();
    }

    function handlePrev(){
      clearInterval(timer);
      if(idx > 0) idx--;
      renderQuestion();
    }

    function computeResults(){
      clearInterval(timer);
      // calculate score
      score = 0;
      for(let i=0;i<QUESTIONS.length;i++){
        if(selected[i] === QUESTIONS[i].a) score++;
      }
      // update UI
      quizArea.classList.add('hidden');
      resultsArea.classList.remove('hidden');
      scoreLarge.textContent = `${score} / ${QUESTIONS.length}`;
      correctCount.textContent = score;
      wrongCount.textContent = QUESTIONS.length - score;
      // final progress to 100%
      progFill.style.width = '100%';
    }

    // review content
    function showReview(){
      reviewList.innerHTML = '';
      QUESTIONS.forEach((Q, i) => {
        const wrapper = document.createElement('div');
        wrapper.className = 'mb-3 p-3 rounded border';
        const qh = document.createElement('div'); qh.innerHTML = `<strong>Q${i+1}.</strong> ${Q.q}`;
        const your = document.createElement('div'); your.className = 'text-sm mt-1';
        const sel = selected[i] !== null ? Q.opts[selected[i]] : '<em>Not answered</em>';
        const correct = Q.opts[Q.a];
        your.innerHTML = `Your answer: ${sel} ${selected[i] === Q.a ? '‚úÖ' : '‚ùå'}<br/><span class="text-xs text-gray-600">Correct: ${correct}</span>`;
        wrapper.appendChild(qh); wrapper.appendChild(your);
        reviewList.appendChild(wrapper);
      });
      reviewModal.classList.remove('hidden');
    }

    // reset to welcome
    function resetQuiz(){
      idx = 0; selected = Array(QUESTIONS.length).fill(null);
      score = 0;
      resultsArea.classList.add('hidden');
      welcomeCard.classList.remove('hidden');
      quizArea.classList.add('hidden');
      reviewModal.classList.add('hidden');
      progFill.style.width = '0%';
      timerFill.style.width = '100%';
      timerLabel.textContent = `‚è± ${msToTime(PER_QUESTION_SECONDS)}`;
    }

    // share helpers
    function getShareText(){
      return `I scored ${score}/${QUESTIONS.length} on EduSijaExpert Quiz! Try it: ${location.href}`;
    }
    async function copyToClipboard(text){
      try{
        await navigator.clipboard.writeText(text);
        alert('Copied to clipboard');
      }catch(e){
        prompt('Copy this text:', text);
      }
    }

    // ---------- event wiring ----------
    startBtn.addEventListener('click', () => {
      welcomeCard.classList.add('hidden');
      resultsArea.classList.add('hidden');
      quizArea.classList.remove('hidden');
      idx = 0;
      selected = Array(QUESTIONS.length).fill(null);
      renderQuestion();
    });

    nextBtn.addEventListener('click', ()=> handleNext(false));
    prevBtn.addEventListener('click', ()=> handlePrev());
    skipBtn.addEventListener('click', ()=> { clearInterval(timer); handleNext(true); });

    reviewBtn.addEventListener('click', showReview);
    closeReview.addEventListener('click', ()=> reviewModal.classList.add('hidden'));
    retryBtn.addEventListener('click', resetQuiz);

    // share buttons
    shareWA.addEventListener('click', ()=> {
      const text = encodeURIComponent(getShareText());
      window.open(`https://wa.me/?text=${text}`, '_blank');
    });
    shareTW.addEventListener('click', ()=> {
      const text = encodeURIComponent(getShareText());
      window.open(`https://twitter.com/intent/tweet?text=${text}`, '_blank');
    });
    shareFB.addEventListener('click', ()=> {
      const u = encodeURIComponent(location.href);
      window.open(`https://www.facebook.com/sharer/sharer.php?u=${u}`, '_blank');
    });
    copyLink.addEventListener('click', ()=> copyToClipboard(getShareText()));

    // prevent double-clicks on Next/Start
    [startBtn, nextBtn, prevBtn, retryBtn, reviewBtn, skipBtn].forEach(btn=>{
      btn.addEventListener('click', (e)=>{
        btn.disabled = true;
        setTimeout(()=> btn.disabled = false, 500);
      });
    });

    // keyboard accessibility: Enter to select focused option, arrow keys to navigate options
    document.addEventListener('keydown', (ev)=>{
      if(quizArea.classList.contains('hidden')) return;
      if(ev.key === 'ArrowRight') { if(!nextBtn.disabled) nextBtn.click(); }
      if(ev.key === 'ArrowLeft') { if(prevBtn.style.visibility !== 'hidden') prevBtn.click(); }
    });

    // Utility function exposed to template
    function msToTime(s){
      const m = Math.floor(s/60); const sec = s%60;
      return (m>0 ? `${String(m).padStart(2,'0')}:` : '') + String(sec).padStart(2,'0');
    }
  </script>
</body>
</html>
